<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/css/my/profile.css">
    <link rel="stylesheet" href="/css/fragment/mypage_navbar.css">
    <link rel="stylesheet" href="/css/fragment/footer.css">
    <script defer src="/js/fragment/mypage_navbar.js"></script>
</head>
<html>

<body>
    <header th:replace="/fragment/header::header"></header>
    <div class="container my lg" style="margin-top: 100px">
        <div>
            <!-- navbar -->
            <nav th:replace="/fragment/mypage_navbar"></nav>
        </div>
        <div class="content_area">
            <div class="my_profile">
                <div class="content_title border">
                    <div class="title">
                        <h3>프로필 정보</h3>
                        <!---->
                    </div>
                    <!---->
                </div>
                <div class="user_profile">
                    <div class="profile_thumb"><img id="profile_img" src="/img/profile.png" alt="사용자 이미지" class="thumb_img read_img"></div>
                    <div class="profile_detail"><strong class="name" id="profile_name">fd730</strong>
                        <div class="profile_btn_box"><label href="#" class="btn outlinegrey small" for="modify_img"> 이미지 변경 </label><a href="#"
                                class="btn outlinegrey small" onclick="delete_img()"> 삭제 </a></div>
                    </div>
                </div><input type="file" id="modify_img" accept="image/jpeg,image/png" hidden="hidden"><canvas width="1000"
                    height="1000" style="display: none;"></canvas>
                <div class="profile_info">
                    <div class="profile_group">
                        <h4 class="group_title">로그인 정보</h4>
                        <div class="unit unit_email">
                            <h5 class="title">이메일 주소</h5>
                            <p class="desc email" id="profile_email">f***0@naver.com</p><button type="button"
                                class="btn btn_modify outlinegrey small"  onclick="pop_email()"> 변경 </button>
                        </div>

                        <div class="modify modify_email" style="display: none;">
                            <div class="input_box">
                                <h6 class="input_title">이메일 주소 변경</h6>
                                <div class="input_item"><input id="change_email" type="email" autocomplete="off" class="input_txt"
                                        placeholder="f***0@naver.com"></div>
                                <p class="input_error"> </p>
                            </div>
                            <div class="modify_btn_box"><button type="button" class="btn outlinegrey medium"
                                    slot="button" onclick="close_email()"> 취소 </button><button disabled="disabled" type="button"
                                    class="btn solid medium disabled" slot="button"> 변경 </button></div>
                        </div>
                        <div class="unit unit_password">
                            <h5 class="title">비밀번호</h5>
                            <p class="desc password" id="profile_password">•••••••••</p><button type="button"
                                class="btn btn_modify outlinegrey small" onclick="pop_password()"> 변경 </button>
                        </div>
                        <div class="modify  modify_password" style="display: none;">
                            <h5 class="title">비밀번호 변경</h5>
                            <div class="input_box">
                                <h6 class="input_title">이전 비밀번호</h6>
                                <div class="input_item"><input type="password" placeholder="영문, 숫자, 특수문자 조합 8-16자"
                                        autocomplete="off" class="input_txt"></div>
                                <p class="input_error"> 영문, 숫자, 특수문자를 조합해서 입력해주세요. (8-16자)
                                </p>
                            </div>
                            <div class="input_box">
                                <h6 class="input_title">새 비밀번호</h6>
                                <div class="input_item"><input type="password" placeholder="영문, 숫자, 특수문자 조합 8-16자"
                                        autocomplete="off" class="input_txt"></div>
                                <p class="input_error"> 영문, 숫자, 특수문자를 조합해서 입력해주세요. (8-16자)
                                </p>
                            </div>
                            <div class="modify_btn_box"><button type="button" class="btn outlinegrey medium"
                                    slot="button" onclick="close_password()"> 취소 </button><button disabled="disabled" type="button"
                                    class="btn solid medium disabled" slot="button"> 저장 </button></div>
                        </div>
                    </div>
                    <div class="profile_group">
                        <h4 class="group_title">개인 정보</h4>
                        <div class="unit unit_name">
                            <h5 class="title">이름</h5>
                            <p class="desc" id="profile_nickname">fd730</p><button type="button" class="btn btn_modify outlinegrey small" onclick="pop_name()"> 변경
                            </button>
                        </div>
                        <div class="modify name modify_name" style="display: none;">
                            <h5 class="title">이름</h5>
                            <div class="input_box" id="name_input_box">
                                <h6 class="input_title">새로운 이름</h6>
                                <div class="input_item"><input type="text" id="name_input" placeholder="고객님의 이름" autocomplete="off"
                                        class="input_txt"></div>
                                <p class="input_error" id="name_input_error"></p>
                            </div>
                            <div class="modify_btn_box"><button type="button" class="btn outlinegrey medium close_name "
                                    slot="button"> 취소 </button><button type="button"
                                    class="btn solid medium disabled close_name" id="name_save"slot="button" disabled="true"> 저장 </button></div>
                        </div>
                        <div class="unit unit_hp">
                            <h5 class="title">휴대폰 번호</h5>
                            <p class="desc" id="profile_hp">010-5***-*794</p><button type="button"
                                class="btn btn_modify outlinegrey small"  onclick="pop_hp()"> 변경 </button>
                        </div>
                        <div class="modify modify_hp" style="display: none;">
                            <h5 class="title">휴대폰 번호</h5>
                            <div class="input_box" id="hp_input_box">
                                <h6 class="input_title">새로운 휴대폰 번호</h6>
                                <div class="input_item"><input type="text" id="hp_input" placeholder="- 없이 입력" autocomplete="off"
                                                               class="input_txt"></div>
                                <p class="input_error" id="hp_input_error"></p>
                            </div>
                            <div class="modify_btn_box"><button type="button" class="btn outlinegrey medium close_name "
                                                                slot="button" onclick="close_hp()"> 취소 </button><button type="button"
                                                                                                   class="btn solid medium disabled close_name" id="hp_save"slot="button" disabled="true"> 저장 </button></div>
                        </div>
                        <div class="unit">
                            <h5 class="title">신발 사이즈</h5>
                            <p class="desc size" id="profile_shoe">260</p><button type="button" class="btn btn_modify outlinegrey small" id ="name_size" onclick="pop_layer();"> 변경
                            </button>
                        </div>
                        <div class="layer lg layer_size" style="display: none;">
                            <div class="layer_container"><a class="btn_layer_close" ></a>
                                <div class="layer_header">
                                    <h2 class="title">사이즈 선택</h2>
                                </div>
                                <div class="layer_content">
                                    <div class="size_list_area">
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">220</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">225</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">230</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">235</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">240</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">245</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">250</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">255</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium on"><span
                                                    class="info_txt">260</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">265</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">270</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">275</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">280</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">285</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">290</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">295</span></a></div>
                                        <div class="size_item"><a class="btn outlinegrey medium "><span
                                                    class="info_txt">300</span></a></div>
                                    </div>
                                    <div class="layer_btn"><a class="btn solid medium" onclick="close_layer();"> 확인 </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <a href="/my/withdrawal" class="btn_withdrawal">회원 탈퇴</a>
                </div>
            </div>
        </div>
    </div>
<footer th:replace="/fragment/footer::footer"></footer>
</body>
<script>
function validateName(strName){
    // const reg_name =  /^[가-힣a-zA-Z]+$/;
    const reg_name = /^[가-힣]{2,50}$/;
    if(!reg_name.test(''+strName)){
        return false;
    }
    return true;
}
let strName=document.querySelector(".unit_name .desc").innerHTML;
document.querySelector('#name_input').addEventListener('input', e=>{
    strName=e.target.value;
    let errorMsg='';
    if(!validateName(strName)){
        errorMsg='올바른 이름을 입력해주세요. (2-50자)';
        document.querySelector('#name_input_box').className='has_button input_box has_error';
        document.querySelector('#name_input').setAttribute('validateresult',false);
        document.querySelector('#name_save').classList.add('disabled');
        document.querySelector('#name_save').disabled = true;

    } else {
        document.querySelector('#name_input_box').className='has_button input_box fill';
        document.querySelector('#name_input').setAttribute('validateresult',true);
        document.querySelector('#name_save').classList.remove('disabled');
        document.querySelector('#name_save').disabled = false;
    }
    document.querySelector('#name_input_error').innerHTML=errorMsg;
});
function pop_email(){
    document.querySelector('.unit_email').style.display="none"
    document.querySelector('.modify_email').style.display="block"
}
function close_email(){
    document.querySelector('.unit_email').style.display="block"
    document.querySelector('.modify_email').style.display="none"
}
function pop_password(){
    document.querySelector('.unit_password').style.display="none"
    document.querySelector('.modify_password').style.display="block"
}
function close_password(){
    document.querySelector('.unit_password').style.display="block"
    document.querySelector('.modify_password').style.display="none"
}
function pop_name(){
    document.querySelector('.unit_name').style.display="none"
    document.querySelector('.modify_name').style.display="block"
}
function pop_hp(){
    document.querySelector('.unit_hp').style.display="none"
    document.querySelector('.modify_hp').style.display="block"
}
function close_hp(){
    document.querySelector('.unit_hp').style.display="block"
    document.querySelector('.modify_hp').style.display="none"
}

const closename =document.querySelectorAll('.close_name')
const layer1 = document.querySelector('.modify_name')
const layer2 = document.querySelector('.unit_name')
closename.forEach((target) => {
            target.addEventListener('click', () => {

                layer1.style.display="none"
                layer2.style.display="block"
                if(validateName(strName)){
                let name=document.querySelector(".unit_name .desc")
                let name1=document.querySelector(".profile_detail .name")
                name.innerHTML=strName
                name1.innerHTML=strName
                }

            })
        })

function close_layer(){
    document.querySelector('.layer_size').style.display="none"
    let size=document.querySelector(".size.desc");
    size.innerHTML= document.querySelector(".size_item .btn.on span").innerHTML
}
function pop_layer(){
    document.querySelector('.layer_size').style.display="block"


}
const boxes = document.querySelectorAll(".size_item .btn");
    boxes.forEach((box) => {
        box.addEventListener("click", () => {
            boxes.forEach((e)=>{
                e.classList.remove("on")
            })
            box.classList.add("on")
        })
    });


    function delete_img(){
    const pi = document.getElementById('profile_img');
    console.log(pi.src);
    pi.setAttribute('src', '../../img/profile.png');
    console.log(pi.src);
}


// 프로필 이미지 변경
function readImage(input){
    // console.log(input);
    if(input.files && input.files[0]){
        const reader = new FileReader();

        reader.onload = e => {
            const newImg = document.getElementById('profile_img');
            newImg.src=e.target.result;
        }
        reader.readAsDataURL(input.files[0]);
    }
}

const modifyImg = document.getElementById('modify_img');
modifyImg.addEventListener("change", e => {
    // console.log(e.target);
    readImage(e.target);
})


</script>


</html>